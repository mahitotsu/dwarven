# アーキテクチャ設計

## システム構成

```
[CSVファイル] 
    ↓
[analyze.py] ← コマンドライン引数
    ↓
[データ読み込み層] (pandas)
    ↓
[統計分析層] (numpy/pandas)
    ↓
[可視化層] (matplotlib)
    ↓
[レポート生成層] (jinja2)
    ↓
[report.html] + [コンソール出力]
```

## モジュール構成

### analyze.py (メインスクリプト)
単一ファイル構成で以下の責務を持つ：

1. **引数解析モジュール** (`parse_arguments()`)
   - コマンドライン引数の受け取り
   - 入力ファイルパス、出力ファイルパスのバリデーション

2. **データ読み込みモジュール** (`load_data()`)
   - CSVファイルの読み込み
   - 日付カラムのパース
   - データ型の検証

3. **統計分析モジュール** (`calculate_statistics()`)
   - 基本統計量の計算
   - 欠損値のチェック

4. **可視化モジュール** (`generate_charts()`)
   - 時系列折れ線グラフの生成
   - ヒストグラムの生成
   - Base64エンコードされた画像データの返却

5. **レポート生成モジュール** (`generate_report()`)
   - HTMLテンプレートへのデータ埋め込み
   - ファイル出力

6. **メイン処理** (`main()`)
   - 全体のフロー制御
   - エラーハンドリング
   - コンソール出力

## データフロー

1. コマンドライン引数からCSVファイルパスを取得
2. pandasでCSVを読み込み、DataFrameとして保持
3. 統計計算を実行し、結果を辞書形式で保持
4. matplotlibでグラフを生成し、Base64文字列として保持
5. 統計情報とグラフをHTMLテンプレートに埋め込み
6. HTMLファイルとして出力、同時にコンソールにサマリー表示

## 技術スタック

- **Python**: 3.10+
- **データ処理**: pandas
- **可視化**: matplotlib
- **CLI**: argparse
- **テンプレート**: Jinja2（オプション、またはf-string）
- **開発ツール**: pytest, black, mypy

## エラーハンドリング

- ファイルが存在しない場合: 明確なエラーメッセージ
- 不正なCSV形式: カラム不足のエラー
- 数値変換エラー: データ型エラーの通知
- 空データ: 処理不可を通知

## パフォーマンス考慮事項

- 小〜中規模データ（〜100万行）を想定
- メモリ内処理で十分
- 大規模データは現時点でスコープ外
